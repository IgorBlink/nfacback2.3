# üé§ Voice-to-Voice –ò–ò –ê–≥–µ–Ω—Ç

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —á–∞—Ç–∞ —Å –ò–ò –∞–≥–µ–Ω—Ç–æ–º Gemini. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç real-time –æ–±—â–µ–Ω–∏–µ –≥–æ–ª–æ—Å-–≤-–≥–æ–ª–æ—Å —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –∫–æ–Ω—Ü–∞ —Ä–µ—á–∏.

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- üéôÔ∏è **–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥** - –ù–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –∑–∞–ø–∏—Å–∏
- ü§ñ **–ò–ò Gemini** - –£–º–Ω—ã–µ –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
- üîä **–ì–æ–ª–æ—Å–æ–≤–æ–π –≤—ã–≤–æ–¥** - –ò–ò –æ—Ç–≤–µ—á–∞–µ—Ç –≥–æ–ª–æ—Å–æ–º
- üéØ **Voice Activity Detection** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ü–∞ —Ä–µ—á–∏
- üåê **WebSocket** - Real-time –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è
- üì± **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω** - –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- ‚å®Ô∏è **–ö–ª–∞–≤–∏–∞—Ç—É—Ä–Ω—ã–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è** - –ü—Ä–æ–±–µ–ª –¥–ª—è –∑–∞–ø–∏—Å–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
```bash
# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/IgorBlink/nfacback2.3.git
cd nfacback2.3

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
python install.py
```

**–†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
# –î–ª—è Python 3.12+ —Å–Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∞–∑–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
pip install --upgrade pip setuptools>=68.0.0 wheel>=0.40.0

# –ó–∞—Ç–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏:
pip install -r requirements-py312.txt

# –î–ª—è macOS –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è:
brew install portaudio
pip install pyaudio

# –î–ª—è Ubuntu/Debian:
sudo apt-get install portaudio19-dev python3-dev
pip install pyaudio
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Gemini API

1. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á –æ—Ç Google AI Studio: https://makersuite.google.com/app/apikey
2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä
cp .env.example .env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª .env
GEMINI_API_KEY=your_gemini_api_key_here
```

### 3. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
python main.py

# –ò–ª–∏ —á–µ—Ä–µ–∑ uvicorn
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ http://localhost:8000

## üéØ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. **–†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
2. **–ù–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ** –∫–Ω–æ–ø–∫—É –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ (üé§)
3. **–ì–æ–≤–æ—Ä–∏—Ç–µ** –≤–∞—à –≤–æ–ø—Ä–æ—Å –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ
4. **–û—Ç–ø—É—Å—Ç–∏—Ç–µ –∫–Ω–æ–ø–∫—É** –∫–æ–≥–¥–∞ –∑–∞–∫–æ–Ω—á–∏—Ç–µ –≥–æ–≤–æ—Ä–∏—Ç—å
5. **–î–æ–∂–¥–∏—Ç–µ—Å—å –æ—Ç–≤–µ—Ç–∞** –ò–ò –∞–≥–µ–Ω—Ç–∞

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –∑–∞–ø–∏—Å–∏:
- **–ü—Ä–æ–±–µ–ª** - –Ω–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –¥–ª—è –∑–∞–ø–∏—Å–∏
- **–ú–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞** - touch –ø–æ–¥–¥–µ—Ä–∂–∫–∞

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
voice-ai-agent/
‚îú‚îÄ‚îÄ main.py                 # –û—Å–Ω–æ–≤–Ω–æ–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ config.py              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt       # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ README.md             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ .env.example          # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ services/             # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ audio_service.py   # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ –∏ VAD
‚îÇ   ‚îú‚îÄ‚îÄ gemini_service.py  # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Gemini API
‚îÇ   ‚îî‚îÄ‚îÄ speech_service.py  # Speech-to-Text –∏ Text-to-Speech
‚îÇ
‚îú‚îÄ‚îÄ utils/                # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ connection_manager.py  # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ WebSocket
‚îÇ
‚îú‚îÄ‚îÄ templates/            # HTML —à–∞–±–ª–æ–Ω—ã
‚îÇ   ‚îî‚îÄ‚îÄ index.html        # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ
‚îî‚îÄ‚îÄ static/              # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
    ‚îî‚îÄ‚îÄ js/
        ‚îî‚îÄ‚îÄ voice-chat.js  # Frontend JavaScript
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
# API
GEMINI_API_KEY=your_api_key

# –°–µ—Ä–≤–µ—Ä
HOST=0.0.0.0
PORT=8000
DEBUG=True

# –ê—É–¥–∏–æ
SAMPLE_RATE=16000          # –ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏
FRAME_DURATION=30          # –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ—Ä–µ–π–º–∞ (–º—Å)
MAX_SILENCE_FRAMES=30      # –§—Ä–µ–π–º—ã —Ç–∏—à–∏–Ω—ã –¥–æ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL=INFO
```

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

**Backend:**
- FastAPI - –í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- WebSocket - Real-time –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è
- Google Generative AI - –ò–ò –º–æ–¥–µ–ª—å Gemini
- SpeechRecognition - –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏
- gTTS - –°–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏
- WebRTC VAD - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≥–æ–ª–æ—Å–∞
- Pydub - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ

**Frontend:**
- Vanilla JavaScript - –ë–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤
- Web Audio API - –ê–Ω–∞–ª–∏–∑ –∑–≤—É–∫–∞
- MediaRecorder API - –ó–∞–ø–∏—Å—å –∞—É–¥–∏–æ
- WebSocket API - –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º—ã —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±—Ä–∞—É–∑–µ—Ä –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É

### –ü—Ä–æ–±–ª–µ–º—ã —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π PyAudio
```bash
# macOS
brew install portaudio
export LDFLAGS="-L/opt/homebrew/lib"
export CPPFLAGS="-I/opt/homebrew/include"
pip install pyaudio

# Ubuntu/Debian
sudo apt-get install portaudio19-dev python3-dev
pip install pyaudio

# Windows
pip install pipwin
pipwin install pyaudio
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å Gemini API
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ Gemini API
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

## üìù API Endpoints

- `GET /` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- `WebSocket /ws` - WebSocket –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —á–∞—Ç–∞

### WebSocket —Å–æ–æ–±—â–µ–Ω–∏—è

**–ö–ª–∏–µ–Ω—Ç ‚Üí –°–µ—Ä–≤–µ—Ä:**
```json
{
  "type": "audio_chunk",
  "data": "base64_audio_data"
}

{
  "type": "audio_end"
}

{
  "type": "clear_history"
}
```

**–°–µ—Ä–≤–µ—Ä ‚Üí –ö–ª–∏–µ–Ω—Ç:**
```json
{
  "type": "connection_established",
  "session_id": "12345678"
}

{
  "type": "transcription",
  "text": "–†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç"
}

{
  "type": "ai_response",
  "text": "–û—Ç–≤–µ—Ç –ò–ò"
}

{
  "type": "audio_response",
  "data": "base64_audio_data"
}
```

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. Fork –ø—Ä–æ–µ–∫—Ç–∞
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch (`git checkout -b feature/amazing-feature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. Push –≤ branch (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MIT –ª–∏—Ü–µ–Ω–∑–∏—é.

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- Google AI –∑–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ Gemini API
- WebRTC –∑–∞ Voice Activity Detection
- FastAPI –∑–∞ –æ—Ç–ª–∏—á–Ω—ã–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ 